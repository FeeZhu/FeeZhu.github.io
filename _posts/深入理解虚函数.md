## c++理解**虚函数**

学习了c++这么久，但还是对于虚函数这个点不是非常理解。只是有一个大概的印象，虚函数能被继承什么的。重新复习一下虚函数的用法和作用。

### 虚函数作用
简单来讲，虚函数的作用就是使面向对象编程中的动态多态
- 静态多态：程序在编译阶段根据参数个数和形式确定调用那个函数。这种情况下不需要使用虚函数。
- 动态多态：利用虚函数实现了运行时的多态，系统编译的时候不知道程序要调用的函数。
>虚函数：就是在基类中声明该函数是虚拟的（在函数之前加virtual关键字），然后在子类中正式的定义（子类中的该函数的函数名，返回值，函数参数个数，参数类型，全都与基类的所声明的虚函数相同，此时才能称为重写，才符合虚函数，否则就是函数的重载），再定义一个指向基类对象的指针，然后使该指针指向由该基类派生的子类对象，再然后用这个指针来调用改虚函数，就能实现动态多态。
### 1. 普通虚函数
``` c++
class A
{
public:
    A(int a = 10)
        :_a(a)
    {}
     virtual void Get()
    {
         cout << "A:: _a=" << _a << endl;
    }
public:
    int _a;
};

class B :  public A
{
public:
    B(int b = 20)
        :_b(b)
    {}
    void Get()
    {
        cout << "B:: _b=" << _b << endl;

    }

    int _b;
};

int main()
{
    A a1;
    B b1;
    A* ptr1 = &a1;
    ptr1->Get();
//可以使用父类指针去访问子类的对象
    ptr1 = &b1;
    ptr1->Get();

    return 0;
}
```

### 2. 虚析构函数
问题：在销毁对象内存的时候则只是执行了父类的析构函数，子类的析构函数却没有执行，这会导致内存泄漏。

解决：使用虚析构函数，找析构函数上加上关键字```virtual```
``` c++
class Shape
{
public:
    ....
    virtual ~Shape();
private:
    ....
};
class Circle:public Shape
{
public:
    virtual ~Circle();//与虚函数相同，此处virtual可以不写，系统将会自动添加，建议写上
    ....
};
```
>virtual在函数中的使用限制
>- 普通函数不能是虚函数，也就是说这个函数必须是某一个类的成员函数，不可以是一个全局函数，否则会导致编译错误。
>- 静态成员函数不能是虚函数 static成员函数是和类同生共处的，他不属于任何对象，使用virtual也将导致错误。
>- 内联函数不能是虚函数 如果修饰内联函数 如果内联函数被virtual修饰，计算机会忽略inline使它变成存粹的虚函数。
>- 构造函数不能是虚函数，否则会出现编译错误。

多态的实现原理：非常复杂。可以理解为类中定义虚函数的时候会生成一个虚函数表的指针，通过该指针可以找到相应的虚函数。

### 3. 纯虚函数
在虚函数原理的基础上，虚函数表中，虚函数的地址是一个有意义的值，如果是纯虚函数就实实在在的写一个0。
``` c++
class Shape
{
    virtual double calcArea()=0//计算面积
    virtual double calcPerimeter()=0//计算周长
};
```
### 4. 抽象类
含有纯虚函数的类被称为抽象类，抽象类子类只有把抽象类当中的所有的纯虚函数都做了实现才可以实例化对象。
### 5. 接口类
仅含有纯虚函数的类称为接口类
实际中接口类一般表示一种能力和一种协议
``` c++
class Shape
{
    virtual double calcArea()=0//计算面积
    virtual double calcPerimeter()=0//计算周长
};
```
